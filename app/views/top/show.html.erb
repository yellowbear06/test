<div id="gmap" style="height:400px;width:600px"></div> <!-- 地図を表示する領域 -->
<p id="address"><%= @place.name %></p> <!-- 住所 -->
  
<script>
function initMap() {
  var target = document.getElementById('gmap');  
  var address = document.getElementById('address').textContent; 
  var geocoder = new google.maps.Geocoder();  
  
  geocoder.geocode({ address: address }, function(results, status){
     if (status === 'OK' && results[0]){  
       //マップのインスタンスを変数に代入
        var map = new google.maps.Map(target, {  
          center: results[0].geometry.location,
          zoom: 14
        });
        console.log(results[0]);
       //マーカーの生成
        var marker = new google.maps.Marker({
          position: results[0].geometry.location,
          map: map,
          animation: google.maps.Animation.DROP
        });
       
       //情報ウィンドウの生成
        var infoWindow = new google.maps.InfoWindow({
          content: 'Hello!',
          pixelOffset: new google.maps.Size(0, 5)
        });
 
       //マーカーにリスナーを設定
       marker.addListener('click', function(){
          infoWindow.open(map, marker);
        });
       
     }else{ 
       alert('失敗しました。理由: ' + status);
       return;
     }
  });
}
</script> 
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAPS_API_KEY'] %>&libraries=places&callback=initMap" async defer></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
